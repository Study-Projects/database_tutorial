## Глава 0. Введение

Это руководство познакомит вас с написанием и администрированием собственного интернет-блога и публикацией его в сети Интернет при помощи языка программирования Python 3 и фреймворка Django версии 1.11.

Почти каждый сайт состоит из двух половинок: дизайн и внешний вид страниц, которые видит пользователь и серверная логика, что делает сервер. Эти две части называют front-end и back-end соответственно. Это руководство больше о серверной логике, мы не ставим целью сделать дизайн красивым, но ознакомим вас с тем, как можно свободно менять его.

####  Почему Python 3?

Ну, для начала, он очень популярен. А чем популярнее язык - тем больше его коммьюнити, а чем больше коммьюнити - тем легче найти доступные статьи по интересующим вас темам, тем легче попасть в него и тем проще получить наиболее квалифицированную помощь. Также огромное общество выпустило огромное множество всяческих модулей для более комфортной работы.

Также он очень прост. Нет никаких “ритуалов” вроде точки с запятой в конце строки, для освоения, всё правда будет очень просто.

#### Почему Django?

Это самый популярный python фреймворк. Разве этого недостаточно?

## Глава 1. Установка зависимостей.

Перед началом работы необходимо создать *виртуальное окружение* (другое название - virtualenv). Virtualenv будет изолировать зависимости Python/Django для каждого отдельного проекта. Это значит, что изменения одного сайта никогда не затронут другие сайты, которые вы разрабатываете. 

Для создания virtualenv в консоли (откройте раздел Поиск и введите команду `cmd`) необходимо выполнить следующие шаги: 

1. Создадим на рабочем столе папку `django_blog`: `mkdir C:\Users\USER\Desktop\django_blog`
2. И разместим в ней виртуальное окружение: `python -m venv C:\Users\USER\Desktop\django_blog\venv`
3. Теперь активируем его: `C:\Users\USER\Desktop\django_blog\venv\Scripts\activate.bat`
4. В начале строки появится приписка (venv), которая показывает, что виртуальное окружение активно. Наконец, чтобы деактивировать виртуальное окружение, достаточно написать `deactivate`.

После выпполнения всех команд можно приступить к установке Django. Для загрузки модулей в Python используется программа, которая называется pip. Для начала установки в консоли необходимо ввести команду `pip install django==1.11.0` (В процессе установки консоль может зависнуть. Если это случилось, необходимо использовать команду `python -m pip install django==1.11.0`. Прервать зависшую установку можно комбинацией клавиш `Ctrl-C`).

Также в процессе разработки нам понадобится система контроля версий - Git. Эта программа отслеживает изменения, происходящие с файлами, чтобы впоследствии можно было восстановить состояние кода на нужный момент времени. Это немного похоже на функцию отслеживания изменений в Microsoft Word, но куда мощнее.

TODO: Узнать есть ли в РЭУ гит

Скачать Git можно [здесь](https://git-scm.com/). Процесс установки может выполнятся согласно инструкции, за исключением шага №5 "Adjusting your PATH environment" (Настройка системной переменной Path). Здесь стоит выбрать "Use Git and optional Unix tools from the Windows Command Prompt" (Запуск Git и соответствующих Unix утилит через командную строку Windows, нижняя опция). Все остальные настройки можно оставить по умолчанию. Также нужно будет выбрать опцию "Checkout Windows-style, commit Unix-style line endings".

После окончания установки необходимо перезапустить командную строку.



## Глава 2. Создание проекта.

Для написания сайтов на фреймворке Django используется структура, согласно которой за каждый раздел сайта отвечает отдельный блок файлов с кодом, название которого app (приложение). Совокупность приложений образует проект. Для создания проекта необходимо запустить ряд стандартных скриптов. Для начала выполните команду `C:\Users\USER\Desktop\django_blog django-admin.exe startproject django_blog . `. Очень важно не потерять точку в конце, чтобы создать проект в текущей директории и не допустить появления лишних папок.  

`django-admin.py` — это скрипт, который создаст необходимую структуру директорий и файлы. Теперь у проекта должна быть следующая структура:

```
django_blog
├───manage.py
└───django_blog
        settings.py
        urls.py
        wsgi.py
        __init__.py
```

`manage.py` — это скрипт, который помогает с управлением сайтом. С помощью него запускается веб-сервер на компьютере без установки дополнительных программ.

Файл `settings.py` содержит настройки для веб-сайта.

Файл `urls.py` содержит список шаблонов, по которым ориентируется urlresolver. Это обеспечивает схему url-адресов сайта

#### Изменение настроек

Внесем изменения в файл `django_blog/settings.py`. Для редактирования файла, нажмите на него ПКМ и выберите пункт "Edit with IDLE". 

В файле `settings.py` нужно найти строку `TIME_ZONE` и внести изменения в соответствии со своим часовым поясом:

`TIME_ZONE = 'Europe/Moscow'`

Аналогично с язоковыми настройками:

`LANGUAGE_CODE = 'ru-ru'`

Также необходимо добавить в настройки информацию о расположении статических файлов (Картинки, файлы с кодом CSS для создания стилей). Спуститесь в конец файла и после переменной STATIC_URL добавьте новую — STATIC_ROOT:

```
STATIC_URL = '/static/'
STATIC_ROOT = os.path.join(BASE_DIR, 'static')
```

TODO: Добавить про ALLOWED_HOSTS

#### Настройка Базы Данных

Существует множество различных баз данных, которые могут хранить данные для сайта. Мы будем использовать стандартную — sqlite3.

Она уже выбрана по умолчанию в файле `django_blog/settings.py`:

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': os.path.join(BASE_DIR, 'db.sqlite3'),
    }
}
```

Для создания базы данных нужно запустить команду `python manage.py migrate` (необходимо находится в директории django_blog, где расположен файл `manage.py`). 

#### Запуск веб-сервера

После успешного создания базы данных можно перейти к запуску веб-сервера, чтобы удостовериться в работоспособности созданного проекта. 

> Веб-сервер - сервер, принимающий HTTP-запросы от клиентов, обычно веб-браузеров, и выдающий им HTTP-ответы, как правило, вместе с HTML-страницей, изображением, файлом, медиа-потоком или другими данными.

Для запуска веб-сервера необходимо находится в директории django_blog, в которой находится файл `manage.py`. 

Выполним команду `python manage.py runserver`.
> В случае возникновения ошибки UnicodeDecodeError используйте команду `python manage.py runserver 0:8000`

После этого откроем браузер, и введем следующий адрес `http://127.0.0.1:8000/`. В случае успеха появится приветсвенное письмо.

![hello_screen](https://github.com/Study-Projects/database_tutorial/blob/master/img/it_worked2.png)

Во время работы веб-сервера консоль будет недоступна для ввода команд. Чтобы иметь такую возможность, нужно открыть еще одно окно терминала, активировать виртуальное окружение и перейти в домашнюю директорию проекта, содержащую файл `manage.py`.




## Глава 4

Для управления содержимым созданной нами базы данных, ее моделей Django предоставляет удобный интерфейс администратора.

Прежде всего нужно создать учетную запись администратора. Для этого в консоли выполните команду `python manage.py createsuperuser`. Введите необходимые данные, нажмите Enter.

Откроем файл `blog/admin.py` и заменим его содержимое на:

```
from django.contrib import admin
from .models import Post

admin.site.register(Post)
```

Данный код позволит отобразить модель `Post` на страницк администратора.

В браузере перейдем по адресу `http://127.0.0.1:8000/admin/`. После авторизации вы увидите панель управления приложениямии и, содержащихся в них, моделями. Перейдите в раздел Post и выполните несколько действий для ознакомления с возможностями интерфейса админа. 
